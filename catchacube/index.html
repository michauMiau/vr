<!DOCTYPE html>
<html>
<head>
    <title>Catchacub</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
</head>
<body>
    <a-scene vr-mode-ui="enabled: false">
        <a-sky color="#ECECEC"></a-sky>
        <a-entity id="player" camera position="0 1.6 0" look-controls>
            <a-entity cursor="rayOrigin: mouse" raycaster="objects: .catchable" geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03" material="color: black; shader: flat"></a-entity>
            <!-- Add visible controllers -->
            <a-entity oculus-touch-controls="hand: left"></a-entity>
            <a-entity oculus-touch-controls="hand: right"></a-entity>
        </a-entity>
        
        <a-entity id="falling-cubes"></a-entity>
    </a-scene>

    <script>
        const fallingCubes = document.querySelector('#falling-cubes');

        const player = document.querySelector('#player');
        const playerCamera = player.querySelector('[camera]');

        const getBoundarySize = () => {
            const vrDisplay = player.sceneEl.renderer.xr.getSession().device;
            const bounds = vrDisplay.stageParameters.bounds;
            if (bounds && bounds.sizeX && bounds.sizeZ) {
                return Math.min(bounds.sizeX, bounds.sizeZ);
            }
            return 1.5; // Set a default size if boundary information is unavailable
        };

        const boundarySize = getBoundarySize();
        const maxBoundaryX = boundarySize / 2;
        const maxBoundaryZ = boundarySize / 2;

        function randomPosition() {
            return {
                x: (Math.random() - 0.5) * maxBoundaryX * 2,
                y: 3,
                z: (Math.random() - 0.5) * maxBoundaryZ * 2
            };
        }

        function createFallingCube() {
            const cube = document.createElement('a-box');
            const position = randomPosition();
            cube.setAttribute('position', position);
            cube.setAttribute('class', 'catchable');
            cube.setAttribute('color', '#FF5733');
            cube.setAttribute('width', '0.5');
            cube.setAttribute('height', '0.5');
            cube.setAttribute('depth', '0.5');
            cube.addEventListener('click', () => {
                fallingCubes.removeChild(cube);
            });
            fallingCubes.appendChild(cube);
        }

        setInterval(createFallingCube, 2000); // Create a new cube every 2 seconds
    </script>
</body>
</html>
